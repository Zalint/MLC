<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matix Livreur - Syst√®me de Commandes</title>
    <meta name="description" content="Syst√®me de prise de commandes et livraisons pour Matix Livreur">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
</head>
<body>
    <!-- Loader -->
    <div id="loader" class="loader">
        <div class="loader-spinner"></div>
        <p>Chargement...</p>
    </div>

    <!-- Header -->
    <header id="header" class="header hidden">
        <div class="header-content">
            <div class="logo">
                <h1>Matix Livreur</h1>
            </div>
            <div class="user-info">
                <span id="username"></span>
                <span id="user-role" class="role-badge"></span>
                <button id="logout-btn" class="btn btn-secondary btn-sm">
                    <span class="icon">üö™</span>
                    D√©connexion
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav id="navigation" class="navigation hidden">
        <div class="nav-container">
            <button class="nav-item" data-page="dashboard">
                <span class="icon">üìä</span>
                <span class="text">Tableau de bord</span>
            </button>
            <button class="nav-item hidden" id="nav-monthly-dashboard" data-page="monthly-dashboard">
                <span class="icon">üìà</span>
                <span class="text">Tableau de bord mensuel</span>
            </button>
            <button class="nav-item hidden" id="nav-mata-monthly-dashboard" data-page="mata-monthly-dashboard">
                <span class="icon">üõí</span>
                <span class="text">Tableau MATA mensuel</span>
            </button>
            <button class="nav-item" data-page="new-order">
                <span class="icon">‚ûï</span>
                <span class="text">Nouvelle commande</span>
            </button>
            <button class="nav-item" data-page="orders">
                <span class="icon">üìã</span>
                <span class="text">Commandes</span>
            </button>
            <button class="nav-item hidden" id="nav-expenses" data-page="expenses">
                <span class="icon">üí∞</span>
                <span class="text">D√©penses</span>
            </button>
            <button class="nav-item hidden" id="nav-users" data-page="users">
                <span class="icon">üë•</span>
                <span class="text">Utilisateurs</span>
            </button>
            <button class="nav-item hidden" id="nav-subscriptions" data-page="subscriptions">
                <span class="icon">üé´</span>
                <span class="text">Packs MLC</span>
            </button>
            <button class="nav-item hidden" id="nav-analytics" data-page="analytics">
                <span class="icon">üìà</span>
                <span class="text">Analytics</span>
            </button>
            <button class="nav-item" id="nav-livreurs" data-page="livreurs" style="display: none;">
                <span class="icon">üöö</span>
                <span class="text">Gestion livreurs</span>
            </button>
            <button class="nav-item" data-page="profile">
                <span class="icon">üë§</span>
                <span class="text">Profil</span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content" class="main-content hidden">
        
        <!-- Page de connexion -->
        <div id="login-page" class="page active">
            <div class="login-container">
                <div class="login-header">
                    <h1>Matix Livreur</h1>
                    <p>Syst√®me de gestion des commandes</p>
                </div>
                
                <form id="login-form" class="login-form">
                    <div class="form-group">
                        <label for="login-username">Nom d'utilisateur</label>
                        <input type="text" id="login-username" name="username" required autocomplete="username">
                    </div>
                    
                    <div class="form-group">
                        <label for="login-password">Mot de passe</label>
                        <div class="password-input">
                            <input type="password" id="login-password" name="password" required autocomplete="current-password">
                            <button type="button" class="password-toggle" data-target="login-password">
                                <span class="icon">üëÅÔ∏è</span>
                            </button>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-full">
                        Se connecter
                    </button>
                    
                    <button type="button" id="change-password-link" class="btn btn-link">
                        Changer de mot de passe
                    </button>
                </form>
                
                <div id="login-error" class="error-message hidden"></div>
            </div>
        </div>

        <!-- Page tableau de bord -->
        <div id="dashboard-page" class="page">
            <div class="page-header">
                <h2>Tableau de bord</h2>
                <div class="page-actions">
                    <button id="refresh-dashboard" class="btn btn-secondary btn-sm">
                        <span class="icon">üîÑ</span>
                        Actualiser
                    </button>
                </div>
            </div>
            
            <!-- Dashboard Date Filter -->
            <div class="dashboard-filters" style="margin-bottom: 1rem; display: flex; align-items: center; gap: 10px; padding: 0 1rem;">
                <label for="dashboard-date-filter" style="font-weight: bold;">Afficher pour le:</label>
                <input type="date" id="dashboard-date-filter" name="dashboard-date" class="form-control" style="width: auto; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div class="dashboard-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üì¶</div>
                        <div class="stat-content">
                            <h3 id="total-orders-today">0</h3>
                            <p id="orders-today-label">Commandes aujourd'hui</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <h3 id="total-amount-today">0 FCFA</h3>
                            <p>Courses</p>
                        </div>
                    </div>
                    
                    <div class="stat-card hidden" id="stat-depenses">
                        <div class="stat-icon">üí∏</div>
                        <div class="stat-content">
                            <h3 id="total-expenses-today">0 FCFA</h3>
                            <p>D√©penses totales</p>
                        </div>
                    </div>
                    
                    <div class="stat-card hidden" id="stat-livreurs">
                        <div class="stat-icon">üöö</div>
                        <div class="stat-content">
                            <h3 id="active-livreurs">0</h3>
                            <p>Livreurs actifs</p>
                        </div>
                    </div>
                </div>
                
                <div class="recent-orders">
                    <h3>Derni√®res commandes</h3>
                    <div id="recent-orders-list" class="orders-list">
                        <!-- Les commandes seront charg√©es ici -->
                    </div>
                </div>
                
                <div class="summary-section hidden" id="manager-summary-section">
                    <h3>R√©capitulatif par livreur</h3>
                    <div id="summary-table-container">
                        <!-- Le tableau r√©capitulatif sera charg√© ici -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Page tableau de bord mensuel -->
        <div id="monthly-dashboard-page" class="page">
            <div class="page-header">
                <h2>Tableau de bord mensuel</h2>
                            <div class="page-actions">
                <button id="export-monthly-excel" class="btn btn-primary btn-sm">
                    <span class="icon">üìä</span>
                    Export Excel
                </button>
                <button id="refresh-monthly-dashboard" class="btn btn-secondary btn-sm">
                    <span class="icon">üîÑ</span>
                    Actualiser
                </button>
            </div>
            </div>
            
            <!-- Monthly Dashboard Date Filter -->
            <div class="monthly-dashboard-filters" style="margin-bottom: 1rem; display: flex; align-items: center; gap: 10px; padding: 0 1rem;">
                <label for="monthly-dashboard-date-filter" style="font-weight: bold;">Afficher pour le:</label>
                <input type="month" id="monthly-dashboard-date-filter" name="monthly-dashboard-date" class="form-control" style="width: auto; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div class="monthly-dashboard-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üì¶</div>
                        <div class="stat-content">
                            <h3 id="monthly-total-orders">0</h3>
                            <p id="monthly-orders-label">Commandes</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <h3 id="monthly-total-amount">0 FCFA</h3>
                            <p>Courses</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üí∏</div>
                        <div class="stat-content">
                            <h3 id="monthly-total-expenses">0 FCFA</h3>
                            <p>D√©penses totales</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üöö</div>
                        <div class="stat-content">
                            <h3 id="monthly-active-livreurs">0</h3>
                            <p>Livreurs actifs</p>
                        </div>
                    </div>
                </div>
                
                <div class="monthly-summary-section">
                    <h3>R√©capitulatif par livreur</h3>
                    <div id="monthly-summary-table-container">
                        <!-- Le tableau r√©capitulatif mensuel sera charg√© ici -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Page tableau de bord MATA mensuel -->
        <div id="mata-monthly-dashboard-page" class="page">
            <div class="page-header">
                <h2>Tableau de bord mensuel MATA</h2>
                <div class="page-actions">
                    
                    <button id="refresh-mata-monthly-dashboard" class="btn btn-secondary btn-sm">
                        <span class="icon">üîÑ</span>
                        Actualiser
                    </button>
                </div>
            </div>
            
            <!-- MATA Monthly Dashboard Date Filter -->
            <div class="mata-monthly-dashboard-filters" style="margin-bottom: 1rem; display: flex; align-items: center; gap: 10px; padding: 0 1rem;">
                <label for="mata-monthly-date-filter" style="font-weight: bold;">Afficher pour le:</label>
                <input type="month" id="mata-monthly-date-filter" name="mata-monthly-date" class="form-control" style="width: auto; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div class="mata-monthly-dashboard-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üõí</div>
                        <div class="stat-content">
                            <h3 id="mata-total-orders">0</h3>
                            <p id="mata-orders-label">Commandes MATA</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <h3 id="mata-total-amount">0 FCFA</h3>
                            <p>Montant total</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üöö</div>
                        <div class="stat-content">
                            <h3 id="mata-active-livreurs">0</h3>
                            <p>Livreurs actifs</p>
                        </div>
                    </div>
                </div>
                
                <div class="mata-orders-section">
                    <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>D√©tail des commandes MATA</h3>
                        <button id="export-mata-monthly-excel-table" class="btn btn-primary btn-sm">
                            <span class="icon">üìä</span>
                            Export Excel
                        </button>
                    </div>
                    <div id="mata-orders-table-container">
                        <!-- Le tableau des commandes MATA sera charg√© ici -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Page nouvelle commande -->
        <div id="new-order-page" class="page">
            <div class="page-header">
                <h2>Nouvelle commande</h2>
            </div>
            
            <form id="new-order-form" class="order-form">
                <div class="form-group">
                    <label for="order-type">Type de commande *</label>
                    <select id="order-type" name="order_type" required>
                        <option value="">S√©lectionner un type</option>
                        <option value="MATA">MATA</option>
                        <option value="MLC">MLC</option>
                        <option value="AUTRE">AUTRE</option>
                    </select>
                </div>
                <div class="form-group" id="subscription-toggle-group" style="display: none;">
                    <label for="use-subscription">Utiliser un abonnement</label>
                    <div class="toggle-switch">
                        <input type="checkbox" id="use-subscription" name="use_subscription">
                        <label for="use-subscription"></label>
                    </div>
                </div>
                <div class="form-group" id="subscription-select-group" style="display: none;">
                    <label for="subscription-select">S√©lectionner un abonnement</label>
                    <select id="subscription-select" name="subscription_id">
                        <option value="">Charger les abonnements...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="client-name">Nom du client *</label>
                    <input type="text" id="client-name" name="client_name" required>
                </div>
                <div class="form-group">
                    <label for="phone-number">Num√©ro de t√©l√©phone *</label>
                    <input type="tel" id="phone-number" name="phone_number" required 
                           placeholder="Ex: 773920000">
                </div>
                <div class="form-group" id="adresse-source-group" style="display: none;">
                    <label for="adresse-source">Adresse source *</label>
                    <textarea id="adresse-source" name="adresse_source" rows="2" placeholder="Adresse de d√©part"></textarea>
                </div>
                <div class="form-group" id="adresse-destination-group" style="display: none;">
                    <label for="adresse-destination">Adresse destination *</label>
                    <textarea id="adresse-destination" name="adresse_destination" rows="2" placeholder="Adresse d'arriv√©e"></textarea>
                </div>
                <div class="form-group" id="point-vente-group" style="display: none;">
                    <label for="point-vente">Point de vente *</label>
                    <select id="point-vente" name="point_de_vente">
                        <option value="">S√©lectionner un point de vente</option>
                        <option value="O.Foire">O.Foire</option>
                        <option value="Mbao">Mbao</option>
                        <option value="Keur Massar">Keur Massar</option>
                    </select>
                </div>
                <div class="form-group" id="address-group" style="display: none;">
                    <label for="address">Adresse</label>
                    <textarea id="address" name="address" rows="3" placeholder="Adresse de livraison (optionnel)"></textarea>
                </div>
                <div class="form-group">
                    <label for="description">Description</label>
                    <textarea id="description" name="description" rows="4" 
                              placeholder="Description d√©taill√©e de la commande"></textarea>
                </div>
                <div class="form-group" id="livreur-select-group" style="display: none;">
                    <label for="livreur-select">Livreur (assigner √†)</label>
                    <select id="livreur-select" name="created_by">
                        <option value="">S√©lectionner un livreur</option>
                        <!-- Options dynamiques JS -->
                    </select>
                </div>
                <div class="form-group" id="course-price-group" style="display: none;">
                    <label for="course-price">Prix de la course (FCFA)</label>
                    <input type="number" id="course-price" name="course_price" step="0.01" min="0" 
                           value="1500">
                </div>
                
                <!-- Nouveau groupe pour le suppl√©ment MLC -->
                <div class="form-group" id="supplement-toggle-group" style="display: none;">
                    <label for="add-supplement">Ajouter suppl√©ment</label>
                    <div class="toggle-switch">
                        <input type="checkbox" id="add-supplement" name="add_supplement">
                        <label for="add-supplement"></label>
                    </div>
                </div>
                
                <div class="form-group" id="supplement-options-group" style="display: none;">
                    <label>Montant du suppl√©ment (FCFA)</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="supplement-500" name="supplement_amount" value="500">
                            <label for="supplement-500">500 FCFA</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="supplement-1000" name="supplement_amount" value="1000">
                            <label for="supplement-1000">1000 FCFA</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="supplement-1500" name="supplement_amount" value="1500">
                            <label for="supplement-1500">1500 FCFA</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="supplement-other" name="supplement_amount" value="other">
                            <label for="supplement-other">Autre</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group" id="supplement-custom-group" style="display: none;">
                    <label for="supplement-custom-amount">Montant personnalis√© (FCFA)</label>
                    <input type="number" id="supplement-custom-amount" name="supplement_custom_amount" 
                           step="0.01" min="0" placeholder="Entrer le montant">
                </div>
                
                <div class="form-group" id="amount-group" style="display: none;">
                    <label for="amount">Montant du panier (FCFA)</label>
                    <input type="number" id="amount" name="amount" step="0.01" min="0" 
                           placeholder="0.00">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <span class="icon">‚úÖ</span>
                        Cr√©er la commande
                    </button>
                    <button type="reset" class="btn btn-secondary">
                        <span class="icon">üîÑ</span>
                        R√©initialiser
                    </button>
                </div>
            </form>
            
            <div class="recent-user-orders">
                <h3>Mes 5 derni√®res commandes</h3>
                <div id="user-recent-orders" class="orders-list">
                    <!-- Les derni√®res commandes de l'utilisateur -->
                </div>
            </div>
        </div>

        <!-- Page commandes -->
        <div id="orders-page" class="page">
            <div class="page-header">
                <h2>Commandes enregistr√©es</h2>
                <div class="page-actions">
                    <input type="date" id="orders-date-filter" class="date-input">
                    <button id="export-excel" class="btn btn-primary btn-sm hidden">
                        <span class="icon">üìä</span>
                        Export Excel
                    </button>
                </div>
            </div>
            
            <div class="orders-content">
                <div id="orders-list" class="orders-list">
                    <!-- Les commandes seront charg√©es ici -->
                </div>
                
                <div class="pagination hidden" id="orders-pagination">
                    <button id="prev-page" class="btn btn-secondary btn-sm">Pr√©c√©dent</button>
                    <span id="page-info">Page 1 sur 1</span>
                    <button id="next-page" class="btn btn-secondary btn-sm">Suivant</button>
                </div>
            </div>
        </div>

        <!-- Page d√©penses -->
        <div id="expenses-page" class="page">
            <div class="page-header">
                <h2>Gestion des d√©penses</h2>
                <div class="page-actions">
                    <div class="date-filter-group">
                        <label for="expenses-date-filter" style="font-weight: 600; color: #374151; margin-right: 0.5rem; cursor: pointer;">Date :</label>
                        <div style="position: relative; display: inline-block;">
                            <input 
                                type="date" 
                                id="expenses-date-filter" 
                                class="date-input" 
                                title="Cliquer pour s√©lectionner une date"
                                placeholder="S√©lectionner une date"
                                style="pointer-events: auto; cursor: pointer; padding-right: 35px;"
                            >
                            <button 
                                type="button" 
                                id="date-picker-helper" 
                                style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 16px; color: #2563eb;"
                                title="Ouvrir le s√©lecteur de date"
                            >üìÖ</button>
                        </div>
                    </div>
                    <button id="add-expense-btn" class="btn btn-primary btn-sm hidden" data-manager-only>
                        <span class="icon">‚ûï</span>
                        Nouvelle d√©pense
                    </button>
                </div>
            </div>
            
            <div class="expenses-content">
                <div id="expenses-summary" class="expenses-summary">
                    <!-- Le r√©capitulatif des d√©penses sera charg√© ici -->
                </div>
            </div>
        </div>

        <!-- Page utilisateurs (managers/admins) -->
        <div id="users-page" class="page">
            <div class="page-header">
                <h2>Gestion des utilisateurs</h2>
                <div class="page-actions">
                    <button id="add-user-btn" class="btn btn-primary btn-sm">
                        <span class="icon">‚ûï</span>
                        Nouvel utilisateur
                    </button>
                </div>
            </div>
            
            <div class="users-content">
                <div id="users-list" class="users-list">
                    <!-- Les utilisateurs seront charg√©s ici -->
                </div>
            </div>
        </div>

        <!-- Page abonnements MLC (managers/admins) -->
        <div id="subscriptions-page" class="page">
            <div class="page-header">
                <h2>Gestion des abonnements MLC</h2>
                <div class="page-actions">
                    <input type="text" id="subscription-search" placeholder="Rechercher par nom, t√©l√©phone ou num√©ro de carte..." class="search-input">
                    <button id="add-subscription-btn" class="btn btn-primary btn-sm">
                        <span class="icon">üé´</span>
                        Nouvelle carte
                    </button>
                    <button id="refresh-subscriptions" class="btn btn-secondary btn-sm">
                        <span class="icon">üîÑ</span>
                        Actualiser
                    </button>
                </div>
            </div>
            
            <div class="subscriptions-content">
                <div class="subscriptions-stats">
                    <div class="stat-card">
                        <div class="stat-icon">üé´</div>
                        <div class="stat-content">
                            <h3 id="total-subscriptions">0</h3>
                            <p>Total cartes</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <h3 id="active-subscriptions">0</h3>
                            <p>Cartes actives</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üèÅ</div>
                        <div class="stat-content">
                            <h3 id="completed-subscriptions">0</h3>
                            <p>Cartes termin√©es</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-content">
                            <h3 id="expiring-subscriptions">0</h3>
                            <p>Expirent bient√¥t</p>
                        </div>
                    </div>
                </div>
                <div style="background: linear-gradient(135deg, #2563eb, #3b82f6); padding: 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3);">
                    <button id="add-subscription-btn-main" class="btn btn-primary btn-sm" data-manager-only style="
                      background: #ffffff; 
                      color: #2563eb; 
                      border: none; 
                      padding: 15px 30px; 
                      font-size: 18px; 
                      font-weight: bold; 
                      border-radius: 8px; 
                      cursor: pointer; 
                      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                      transition: all 0.3s ease;
                    ">
                      ‚ûï AJOUTER UNE NOUVELLE CARTE
                    </button>
                    <p style="color: white; margin-top: 10px; font-size: 14px;">Cliquez ici pour cr√©er un nouveau livreur</p>
                  </div>
                
                <div class="subscriptions-section">
                    <h3>Cartes d'abonnement</h3>
                    <div id="subscriptions-list" class="subscriptions-list">
                        <!-- Les cartes d'abonnement seront charg√©es ici -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Page Analytics -->
        <div id="analytics-page" class="page">
            <div class="page-header">
                <h2>Analytics & Statistiques</h2>
                <div class="page-actions">
                    <button id="refresh-analytics" class="btn btn-secondary btn-sm">
                        <span class="icon">üîÑ</span>
                        Actualiser
                    </button>
                </div>
            </div>
            
            <!-- Filtres d'analyse -->
            <div class="analytics-filters" style="margin-bottom: 2rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; align-items: end;">
                    <div class="form-group">
                        <label for="analytics-date-start" style="font-weight: bold;">Date d√©but</label>
                        <input type="date" id="analytics-date-start" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="analytics-date-end" style="font-weight: bold;">Date fin</label>
                        <input type="date" id="analytics-date-end" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="analytics-livreur-filter" style="font-weight: bold;">Livreur</label>
                        <select id="analytics-livreur-filter" class="form-control">
                            <option value="">Tous les livreurs</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="analytics-type-filter" style="font-weight: bold;">Type de course</label>
                        <select id="analytics-type-filter" class="form-control">
                            <option value="">Tous types</option>
                            <option value="MATA">MATA</option>
                            <option value="MLC">MLC classique</option>
                            <option value="MLC_SUBSCRIPTION">MLC abonnement</option>
                            <option value="AUTRE">Autre</option>
                        </select>
                    </div>
                    <div>
                        <button id="apply-analytics-filters" class="btn btn-primary">
                            <span class="icon">üîç</span>
                            Analyser
                        </button>
                    </div>
                </div>
            </div>

            <!-- Statistiques globales -->
            <div class="analytics-global-stats">
                <h3>üìä Statistiques globales</h3>
                <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div class="stat-card">
                        <div class="stat-icon">üì¶</div>
                        <div class="stat-content">
                            <h3 id="analytics-total-orders">0</h3>
                            <p>Total courses</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <h3 id="analytics-total-revenue">0 FCFA</h3>
                            <p>Revenus courses</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∏</div>
                        <div class="stat-content">
                            <h3 id="analytics-total-expenses">0 FCFA</h3>
                            <p>D√©penses totales</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üöó</div>
                        <div class="stat-content">
                            <h3 id="analytics-total-km">0 km</h3>
                            <p>Total kilom√®tres</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üíπ</div>
                        <div class="stat-content">
                            <h3 id="analytics-total-profit">0 FCFA</h3>
                            <p>B√©n√©fices nets</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚õΩ</div>
                        <div class="stat-content">
                            <h3 id="analytics-fuel-expenses">0 FCFA</h3>
                            <p>D√©penses carburant</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analyses par type de course -->
            <div class="analytics-by-type" style="margin-bottom: 2rem;">
                <h3>üìã Analyse par type de course</h3>
                <div id="type-analysis-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                    <!-- Les statistiques par type seront g√©n√©r√©es ici -->
                </div>
            </div>

            <!-- Ranking des livreurs -->
            <div class="analytics-ranking" style="margin-bottom: 2rem;">
                <h3>üèÜ Ranking & Performances</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div class="ranking-section">
                        <h4>ü•á Top livreurs - Global</h4>
                        <div id="global-ranking" class="ranking-list">
                            <!-- Classement global -->
                        </div>
                    </div>
                    <div class="ranking-section">
                        <h4>üì¶ Top livreurs - Par nombre de courses</h4>
                        <div id="orders-ranking" class="ranking-list">
                            <!-- Classement par nombre de courses -->
                        </div>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem;">
                    <div class="ranking-section">
                        <h4>üí∞ Top livreurs - Par revenus</h4>
                        <div id="revenue-ranking" class="ranking-list">
                            <!-- Classement par revenus -->
                        </div>
                    </div>
                    <div class="ranking-section">
                        <h4>üí∏ Top livreurs - B√©n√©fice net (avec salaire)</h4>
                        <div id="net-profit-with-salary-ranking" class="ranking-list">
                            <!-- Classement par b√©n√©fice net avec salaire -->
                        </div>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem;">
                    <div class="ranking-section">
                        <h4>üöó Top livreurs - Par kilom√®tres</h4>
                        <div id="km-ranking" class="ranking-list">
                            <!-- Classement par kilom√®tres -->
                        </div>
                    </div>
                    <div class="ranking-section">
                        <!-- Section vide pour maintenir la grille -->
                    </div>
                </div>
            </div>

            <!-- Analyse comparative entre livreurs -->
            <div class="analytics-comparison" style="margin-bottom: 2rem;">
                <h3>üîç Analyse comparative</h3>
                <div style="background: #ffffff; padding: 1rem; border-radius: 8px; border: 1px solid #e0e0e0;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 1rem; align-items: end; margin-bottom: 1rem;">
                        <div class="form-group">
                            <label for="compare-livreur1" style="font-weight: bold;">Livreur 1</label>
                            <select id="compare-livreur1" class="form-control">
                                <option value="">S√©lectionner le premier livreur</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="compare-livreur2" style="font-weight: bold;">Livreur 2</label>
                            <select id="compare-livreur2" class="form-control">
                                <option value="">S√©lectionner le deuxi√®me livreur</option>
                            </select>
                        </div>
                        <div>
                            <button id="compare-livreurs-btn" class="btn btn-primary">
                                <span class="icon">üîç</span>
                                Comparer
                            </button>
                        </div>
                    </div>
                    <div id="comparison-results" class="comparison-results">
                        <!-- R√©sultats de la comparaison -->
                    </div>
                </div>
            </div>

            <!-- D√©tails par livreur -->
            <div class="analytics-details">
                <h3>üìã D√©tails par livreur</h3>
                <div id="livreur-details-container">
                    <!-- Les d√©tails par livreur seront charg√©s ici -->
                </div>
            </div>
        </div>

        <!-- Page gestion livreurs (managers/admins) -->
        <div id="livreurs-page" class="page">
            <div class="page-header">
                <h2>Gestion des livreurs</h2>
                <div class="page-actions">
                    <button id="add-livreur-btn" class="btn btn-primary btn-sm">
                        <span class="icon">‚ûï</span>
                        Nouveau livreur
                    </button>
                    <button id="show-all-livreurs" class="btn btn-secondary btn-sm">
                        <span class="icon">üëÅÔ∏è</span>
                        Voir tous
                    </button>
                    <button id="show-active-livreurs" class="btn btn-secondary btn-sm">
                        <span class="icon">‚úÖ</span>
                        Actifs seulement
                    </button>
                </div>
            </div>
            
            <div class="livreurs-content">
                <div class="livreurs-stats">
                    <div class="stat-card">
                        <div class="stat-icon">üöö</div>
                        <div class="stat-content">
                            <h3 id="total-livreurs">0</h3>
                            <p>Total livreurs</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <h3 id="active-livreurs-count">0</h3>
                            <p>Livreurs actifs</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ùå</div>
                        <div class="stat-content">
                            <h3 id="inactive-livreurs-count">0</h3>
                            <p>Livreurs inactifs</p>
                        </div>
                    </div>
                </div>
                
                <div id="livreurs-list" class="livreurs-list">
                    <!-- Les livreurs seront charg√©s ici -->
                </div>
            </div>
        </div>

        <!-- Page profil -->
        <div id="profile-page" class="page">
            <div class="page-header">
                <h2>Mon profil</h2>
            </div>
            
            <div class="profile-content">
                <div class="profile-info">
                    <div class="info-group">
                        <label>Nom d'utilisateur</label>
                        <span id="profile-username"></span>
                    </div>
                    <div class="info-group">
                        <label>R√¥le</label>
                        <span id="profile-role" class="role-badge"></span>
                    </div>
                    <div class="info-group">
                        <label>Membre depuis</label>
                        <span id="profile-created"></span>
                    </div>
                </div>
                
                <button id="change-password-btn" class="btn btn-primary">
                    <span class="icon">üîê</span>
                    Changer le mot de passe
                </button>
            </div>
        </div>
    </main>

    <!-- Modales -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modal-title">Titre</h3>
                <button id="modal-close" class="modal-close">√ó</button>
            </div>
            <div class="modal-content" id="modal-content">
                <!-- Contenu dynamique -->
            </div>
        </div>
    </div>

    <!-- Messages toast -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="js/main.js"></script>
</body>
</html> 